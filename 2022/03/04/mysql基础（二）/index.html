<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|EB Garamond:300,300italic,400,400italic,700,700italic|Source Code Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"aeowind.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="初夏愉快">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL基础（二）">
<meta property="og:url" content="https://aeowind.github.io/2022/03/04/mysql%E5%9F%BA%E7%A1%80%EF%BC%88%E4%BA%8C%EF%BC%89/index.html">
<meta property="og:site_name" content="Aeo&#39;s Blog">
<meta property="og:description" content="初夏愉快">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-03-04T12:46:25.424Z">
<meta property="article:modified_time" content="2021-06-02T06:51:54.079Z">
<meta property="article:author" content="aeowind">
<meta property="article:tag" content="学习">
<meta property="article:tag" content="数据库">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://aeowind.github.io/2022/03/04/mysql%E5%9F%BA%E7%A1%80%EF%BC%88%E4%BA%8C%EF%BC%89/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MySQL基础（二） | Aeo's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Aeo's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">你要静候 再静候</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aeowind.github.io/2022/03/04/mysql%E5%9F%BA%E7%A1%80%EF%BC%88%E4%BA%8C%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="aeowind">
      <meta itemprop="description" content="爱上一场认真的消遣">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Aeo's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL基础（二）
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-04 20:46:25" itemprop="dateCreated datePublished" datetime="2022-03-04T20:46:25+08:00">2022-03-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-02 14:51:54" itemprop="dateModified" datetime="2021-06-02T14:51:54+08:00">2021-06-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">学习</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
            <div class="post-description"><blockquote class="blockquote-center">初夏愉快</blockquote></div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="mysql数据库">MySQL数据库</h1>
<h2 id="dml语言">DML语言</h2>
<p><code>数据操作语言:</code><br />
插入：insert<br />
修改：update<br />
删除：delete</p>
<h3 id="插入语句">插入语句</h3>
<blockquote>
<p><strong>方式一</strong>：经典的插入</p>
</blockquote>
<ul>
<li><strong>语法</strong>： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into 表名(字段名,…) values(值,…);</span><br></pre></td></tr></table></figure></li>
<li><strong>特点</strong>:</li>
</ul>
<ol type="1">
<li><p>要求值的类型和字段的类型要一致或兼容；</p></li>
<li><p>字段的个数和顺序不一定与原始表中的字段个数和顺序一致但必须保证值和字段一一对应；</p></li>
<li><p>假如表中有可以为null的字段，注意可以通过以下两种方式插入null值<br />
①字段和值都省略<br />
②字段写上，值使用null</p></li>
<li><p>字段和值的个数必须一致</p></li>
<li><p>字段名可以省略，默认所有列</p></li>
</ol>
<ul>
<li><strong>案例</strong>： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM beauty;</span><br><span class="line">#1.插入的值的类型要与列的类型一致或兼容</span><br><span class="line">INSERT INTO beauty(id,NAME,sex,borndate,phone,photo,boyfriend_id)</span><br><span class="line">VALUES(13,&#x27;唐艺昕&#x27;,&#x27;女&#x27;,&#x27;1990-4-23&#x27;,&#x27;1898888888&#x27;,NULL,2);</span><br><span class="line"></span><br><span class="line">#2.不可以为null的列必须插入值。可以为null的列如何插入值？</span><br><span class="line">    #方法一：</span><br><span class="line">    INSERT INTO beauty(id,NAME,sex,borndate,phone,photo,boyfriend_id)</span><br><span class="line">    VALUES(13,&#x27;唐艺昕&#x27;,&#x27;女&#x27;,&#x27;1990-4-23&#x27;,&#x27;1898888888&#x27;,NULL,2);</span><br><span class="line"></span><br><span class="line">    #方法二：</span><br><span class="line">    INSERT INTO beauty(id,NAME,sex,phone)</span><br><span class="line">    VALUES(15,&#x27;娜扎&#x27;,&#x27;女&#x27;,&#x27;1388888888&#x27;);</span><br><span class="line"></span><br><span class="line">#3.列的顺序是否可以调换</span><br><span class="line">INSERT INTO beauty(NAME,sex,id,phone)</span><br><span class="line">VALUES(&#x27;蒋欣&#x27;,&#x27;女&#x27;,16,&#x27;110&#x27;);</span><br><span class="line"></span><br><span class="line">#4.列数和值的个数必须一致</span><br><span class="line"></span><br><span class="line">INSERT INTO beauty(NAME,sex,id,phone)</span><br><span class="line">VALUES(&#x27;关晓彤&#x27;,&#x27;女&#x27;,17,&#x27;110&#x27;);</span><br><span class="line"></span><br><span class="line">#5.可以省略列名，默认所有列，而且列的顺序和表中列的顺序一致</span><br><span class="line"></span><br><span class="line">INSERT INTO beauty</span><br><span class="line">VALUES(18,&#x27;张飞&#x27;,&#x27;男&#x27;,NULL,&#x27;119&#x27;,NULL,NULL);</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p><strong>方式二语法</strong>：insert into 表名 set 列名=值,列名=值,…
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO beauty SET id=19,NAME=‘刘涛’,phone=‘999’;</span><br></pre></td></tr></table></figure> - <strong>两种方式的区别</strong>: <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1.方式一支持一次插入多行，语法如下：</span><br><span class="line">insert into 表名【(字段名,..)】 values(值，..),(值，...),...;</span><br><span class="line">2.方式一支持子查询，语法如下：</span><br><span class="line">    insert into 表名 查询语句;</span><br><span class="line">    </span><br><span class="line">#1、方式一支持插入多行,方式二不支持</span><br><span class="line"></span><br><span class="line">INSERT INTO beauty</span><br><span class="line">VALUES(23,&#x27;唐艺昕1&#x27;,&#x27;女&#x27;,&#x27;1990-4-23&#x27;,&#x27;1898888888&#x27;,NULL,2)</span><br><span class="line">,(24,&#x27;唐艺昕2&#x27;,&#x27;女&#x27;,&#x27;1990-4-23&#x27;,&#x27;1898888888&#x27;,NULL,2)</span><br><span class="line">,(25,&#x27;唐艺昕3&#x27;,&#x27;女&#x27;,&#x27;1990-4-23&#x27;,&#x27;1898888888&#x27;,NULL,2);</span><br><span class="line"></span><br><span class="line">#2、方式一支持子查询，方式二不支持</span><br><span class="line"></span><br><span class="line">INSERT INTO beauty(id,NAME,phone) SELECT 26,&#x27;宋茜&#x27;,&#x27;11809866&#x27;;</span><br><span class="line"></span><br><span class="line">INSERT INTO beauty(id,NAME,phone) </span><br><span class="line">SELECT id,boyname,&#x27;1234567&#x27; FROM boys WHERE id&lt;3;       </span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="修改语句">修改语句</h3>
<h4 id="修改单表的记录">修改单表的记录★</h4>
<ul>
<li><strong>语法:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update 表名 set 列=新值,列=新值,… where 筛选条件;</span><br></pre></td></tr></table></figure></li>
<li><strong>案例:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#1.修改单表的记录</span><br><span class="line">#案例1：修改beauty表中姓唐的女神的电话为13899888899</span><br><span class="line">UPDATE beauty SET phone = &#x27;13899888899&#x27;</span><br><span class="line">WHERE NAME LIKE &#x27;唐%&#x27;;</span><br><span class="line"></span><br><span class="line">#案例2：修改boys表中id好为2的名称为张飞，魅力值 10</span><br><span class="line">UPDATE boys SET boyname=&#x27;张飞&#x27;,usercp=10</span><br><span class="line">WHERE id=2;</span><br></pre></td></tr></table></figure> ####
修改多表的记录【补充】</li>
<li>sql92语法:<br />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update 表1 别名,表2 别名 set 列=值,… where 连接条件 and 筛选条件;  </span><br></pre></td></tr></table></figure></li>
<li>sql99语法： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update 表1 别名 inner|left|right join 表2 别名 on 连接条件 set 列=值,… where 筛选条件;  </span><br></pre></td></tr></table></figure></li>
<li><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#2.修改多表的记录</span><br><span class="line">#案例 1：修改张无忌的女朋友的手机号为114</span><br><span class="line">UPDATE boys bo</span><br><span class="line">INNER JOIN beauty b ON bo.`id`=b.`boyfriend_id`</span><br><span class="line">SET b.`phone`=&#x27;119&#x27;,bo.`userCP`=1000</span><br><span class="line">WHERE bo.`boyName`=&#x27;张无忌&#x27;;</span><br><span class="line"></span><br><span class="line">#案例2：修改没有男朋友的女神的男朋友编号都为2号</span><br><span class="line">UPDATE boys bo</span><br><span class="line">RIGHT JOIN beauty b ON bo.`id`=b.`boyfriend_id`</span><br><span class="line">SET b.`boyfriend_id`=2 WHERE bo.`id` IS NULL;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="删除语句">删除语句</h3>
<h4 id="方式一delete">方式一：delete</h4>
<ul>
<li><strong>语法：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1、单表的删除【★】</span><br><span class="line">delete from 表名 where 筛选条件</span><br><span class="line"></span><br><span class="line">2、多表的删除【补充】</span><br><span class="line"></span><br><span class="line">sql92语法：</span><br><span class="line">delete 表1的别名,表2的别名</span><br><span class="line">from 表1 别名,表2 别名</span><br><span class="line">where 连接条件</span><br><span class="line">and 筛选条件;</span><br><span class="line"></span><br><span class="line">sql99语法：</span><br><span class="line">delete 表1的别名,表2的别名</span><br><span class="line">from 表1 别名</span><br><span class="line">inner|left|right join 表2 别名 on 连接条件</span><br><span class="line">where 筛选条件;</span><br></pre></td></tr></table></figure></li>
<li><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#1.单表的删除</span><br><span class="line">#案例：删除手机号以9结尾的女神信息</span><br><span class="line">DELETE FROM beauty WHERE phone LIKE &#x27;%9&#x27;;</span><br><span class="line">SELECT * FROM beauty;</span><br><span class="line"></span><br><span class="line">#2.多表的删除</span><br><span class="line">#案例：删除张无忌的女朋友的信息</span><br><span class="line">DELETE b</span><br><span class="line">FROM beauty b</span><br><span class="line">INNER JOIN boys bo ON b.`boyfriend_id` = bo.`id`</span><br><span class="line">WHERE bo.`boyName`=&#x27;张无忌&#x27;;</span><br><span class="line"></span><br><span class="line">#案例：删除黄晓明的信息以及他女朋友的信息</span><br><span class="line">DELETE b,bo</span><br><span class="line">FROM beauty b</span><br><span class="line">INNER JOIN boys bo ON b.`boyfriend_id`=bo.`id`</span><br><span class="line">WHERE bo.`boyName`=&#x27;黄晓明&#x27;;</span><br></pre></td></tr></table></figure> #### 方式二：truncate</li>
<li><strong>语法</strong>：truncate table 表名;</li>
</ul>
<h4 id="两种方式的区别面试题">两种方式的区别【面试题】★</h4>
<ol type="1">
<li><code>delete</code>可以加where
条件，<code>truncate</code>不能加</li>
<li><code>truncate</code>删除，效率高一点</li>
<li>假如要删除的表中有自增长列，
如果用<code>delete</code>删除后，再插入数据，自增长列的值从断点开始，而<code>truncate</code>删除后，再插入数据，自增长列的值从1开始。</li>
<li><code>truncate</code>删除没有返回值，<code>delete</code>删除有返回值</li>
<li><code>truncate</code>删除不能回滚，<code>delete</code>删除可以回滚.</li>
</ol>
<h2 id="ddl语言">DDL语言</h2>
<h3 id="库的管理">库的管理</h3>
<h4 id="创建库">创建库</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create database 【if not exists】 库名【 character set 字符集名】;</span><br><span class="line">#案例：创建库Books</span><br><span class="line">  CREATE DATABASE IF NOT EXISTS books ;</span><br></pre></td></tr></table></figure>
<h4 id="修改库">修改库</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter database 库名 character set 字符集名;</span><br><span class="line">#案例：更改库的字符集</span><br><span class="line">ALTER DATABASE books CHARACTER SET gbk;</span><br></pre></td></tr></table></figure>
<h4 id="删除库">删除库</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">drop database 【if exists】 库名;</span><br><span class="line">#案例：库的删除</span><br><span class="line">DROP DATABASE IF EXISTS books;</span><br></pre></td></tr></table></figure>
<h3 id="表的管理">表的管理</h3>
<h4 id="表的创建">表的创建 ★</h4>
<ul>
<li><strong>语法：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line">	列名 列的类型【(长度) 约束】,</span><br><span class="line">	列名 列的类型【(长度) 约束】,</span><br><span class="line">	列名 列的类型【(长度) 约束】,</span><br><span class="line">	...</span><br><span class="line">	列名 列的类型【(长度) 约束】</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
<li><strong>案例：</strong><br />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">创建表Book</span><br><span class="line">CREATE TABLE book (</span><br><span class="line">  id INT,</span><br><span class="line">  #编号</span><br><span class="line">  bName VARCHAR (20),</span><br><span class="line">  #图书名</span><br><span class="line">  price DOUBLE,</span><br><span class="line">  #价格</span><br><span class="line">  authorId INT,</span><br><span class="line">  #作者编号</span><br><span class="line">  publishDate DATETIME#出版日期</span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line">DESC book;</span><br><span class="line"></span><br><span class="line">创建表author</span><br><span class="line">CREATE TABLE IF NOT EXISTS author (</span><br><span class="line">  id INT,</span><br><span class="line">  au_n`author`ame VARCHAR (20),</span><br><span class="line">  nation VARCHAR (10)</span><br><span class="line">);</span><br><span class="line">DESC author ;</span><br></pre></td></tr></table></figure> #### 表的修改</li>
</ul>
<ol type="1">
<li><strong>添加列</strong><br />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 add column 列名 类型 【first|after 字段名】;</span><br></pre></td></tr></table></figure></li>
<li><strong>修改列的类型或约束</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 modify column 列名 新类型 【新约束】;</span><br></pre></td></tr></table></figure></li>
<li><strong>修改列名</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter table 表名 change column 旧列名 新列名 类型;</span><br></pre></td></tr></table></figure></li>
<li><strong>删除列</strong> alter table 表名 drop column 列名;</li>
<li><strong>修改表名</strong> alter table 表名 rename 【to】
新表名;</li>
</ol>
<ul>
<li><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#①修改列名</span><br><span class="line">ALTER TABLE book CHANGE COLUMN publishdate pubDate DATETIME ;</span><br><span class="line"></span><br><span class="line">#②修改列的类型或约束</span><br><span class="line">ALTER TABLE book MODIFY COLUMN pubdate TIMESTAMP;</span><br><span class="line"></span><br><span class="line">#③添加新列</span><br><span class="line">ALTER TABLE author ADD COLUMN annual DOUBLE; </span><br><span class="line"></span><br><span class="line">#④删除列</span><br><span class="line">ALTER TABLE book_author DROP COLUMN  annual;</span><br><span class="line"></span><br><span class="line">#⑤修改表名</span><br><span class="line">ALTER TABLE book_author RENAME TO author;</span><br><span class="line"></span><br><span class="line">DESC book;</span><br></pre></td></tr></table></figure> #### 表的删除 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">drop table【if exists】 表名;</span><br><span class="line"></span><br><span class="line">案例：</span><br><span class="line">DROP TABLE IF EXISTS book_author;</span><br><span class="line"></span><br><span class="line">SHOW TABLES;</span><br><span class="line"></span><br><span class="line">#通用的写法：</span><br><span class="line">DROP DATABASE IF EXISTS 旧库名;</span><br><span class="line">CREATE DATABASE 新库名 ;</span><br><span class="line"></span><br><span class="line">DROP TABLE IF EXISTS 旧表名;</span><br><span class="line">CREATE TABLE  表名();</span><br></pre></td></tr></table></figure>
#### 复制表</li>
</ul>
<ol type="1">
<li><strong>复制表的结构</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table 表名 like 旧表;</span><br></pre></td></tr></table></figure></li>
<li><strong>复制表的结构+数据</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create table 表名 </span><br><span class="line">select 查询列表 from 旧表【where 筛选】;</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><strong>案例:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO author VALUES</span><br><span class="line">(1,&#x27;村上春树&#x27;,&#x27;日本&#x27;),</span><br><span class="line">(2,&#x27;莫言&#x27;,&#x27;中国&#x27;),</span><br><span class="line">(3,&#x27;冯唐&#x27;,&#x27;中国&#x27;),</span><br><span class="line">(4,&#x27;金庸&#x27;,&#x27;中国&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM Author;</span><br><span class="line">SELECT * FROM copy2;</span><br><span class="line"></span><br><span class="line">#1.仅仅复制表的结构</span><br><span class="line">CREATE TABLE copy LIKE author;</span><br><span class="line"></span><br><span class="line">#2.复制表的结构+数据</span><br><span class="line">CREATE TABLE copy2 SELECT * FROM author;</span><br><span class="line"></span><br><span class="line">#只复制部分数据</span><br><span class="line">CREATE TABLE copy3 SELECT id,au_name</span><br><span class="line">FROM author WHERE nation=&#x27;中国&#x27;;</span><br><span class="line"></span><br><span class="line">#仅仅复制某些字段</span><br><span class="line">CREATE TABLE copy4 SELECT id,au_name</span><br><span class="line">FROM author WHERE 0;</span><br></pre></td></tr></table></figure> ### 数据类型 #### 数值型 #####
整形</li>
<li><strong>分类：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tinyint、smallint、mediumint、int/integer、bigint  </span><br><span class="line">1	       2		   3	       4		 8</span><br></pre></td></tr></table></figure></li>
<li><strong>特点：</strong></li>
</ul>
<ol type="1">
<li>如果不设置无符号还是有符号，默认是有符号，如果想设置无符号，需要添加unsigned关键字<br />
</li>
<li>如果插入的数值超出了整型的范围,会报out of
range异常，并且插入临界值</li>
<li>如果不设置长度，会有默认的长度<br />
长度代表了显示的最大宽度，如果不够会用0在左边填充，但必须搭配zerofill使用！<br />
</li>
</ol>
<ul>
<li><p><strong>案例:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#1.如何设置无符号和有符号</span><br><span class="line">DROP TABLE IF EXISTS tab_int ;</span><br><span class="line"></span><br><span class="line">CREATE TABLE tab_int (t1 INT (7) ZEROFILL, t2 INT (7) ZEROFILL) ;</span><br><span class="line"></span><br><span class="line">DESC tab_int ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_int VALUES (- 123456) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_int VALUES (- 123456, - 123456) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_int VALUES (2147483648, 4294967296) ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_int VALUES (123, 123) ;</span><br><span class="line"></span><br><span class="line">SELECT * FROM tab_int ;</span><br></pre></td></tr></table></figure> ##### 浮点型</p></li>
<li><p>定点数：dec(M,D)；decimal(M,D)</p></li>
<li><p>浮点数：float(M,D) 4；double(M,D) 8</p></li>
<li><p>特点：</p></li>
</ul>
<ol type="1">
<li>M代表整数部位+小数部位的个数，D代表小数部位</li>
<li>如果超出范围，则报out or range异常，并且插入临界值</li>
<li>M和D都可以省略，但对于定点数，M默认为10，D默认为0</li>
<li>如果精度要求较高，则优先考虑使用定点数</li>
</ol>
<ul>
<li><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#测试M和D</span><br><span class="line">DROP TABLE tab_float ;</span><br><span class="line"></span><br><span class="line">CREATE TABLE tab_float (f1 FLOAT, f2 DOUBLE, f3 DECIMAL) ;</span><br><span class="line"></span><br><span class="line">SELECT * FROM tab_float ;</span><br><span class="line"></span><br><span class="line">DESC tab_float ;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_float VALUES(123.4523,123.4523,123.4523);</span><br><span class="line">INSERT INTO tab_float VALUES(123.456,123.456,123.456);</span><br><span class="line">INSERT INTO tab_float VALUES(123.4,123.4,123.4);</span><br><span class="line">INSERT INTO tab_float VALUES(1523.4,1523.4,1523.4);</span><br><span class="line"></span><br><span class="line">#原则：</span><br><span class="line">#所选择的类型越简单越好，能保存数值的类型越小越好</span><br></pre></td></tr></table></figure> #### 字符型
<strong>较短的文本：</strong>
<code>char</code>、<code>varchar</code></li>
</ul>
<p><strong>其他：</strong><br />
<code>binary</code>和<code>varbinary</code>用于保存较短的二进制<br />
<code>enum</code>用于保存枚举<br />
<code>set</code>用于保存集合</p>
<p><strong>较长的文本:</strong><code>text</code>、<code>blob</code>(较大的二进制)</p>
<ul>
<li><strong>特点：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> 写法			M的意思			特点		                     空间的耗费	       效率</span><br><span class="line">char	char(M)		最大的字符数，可以省略，默认为1	 固定长度的字符	比较耗费	  高</span><br><span class="line"></span><br><span class="line">varchar	varchar(M)	最大的字符数，不可以省略			可变长度的字符 比较节省		低</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tab_char(</span><br><span class="line">	c1 ENUM(&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;a&#x27;);</span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;b&#x27;);</span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;c&#x27;);</span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;m&#x27;);</span><br><span class="line">INSERT INTO tab_char VALUES(&#x27;A&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM tab_set;</span><br><span class="line"></span><br><span class="line">CREATE TABLE tab_set(</span><br><span class="line">	s1 SET(&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;)</span><br><span class="line">);</span><br><span class="line">INSERT INTO tab_set VALUES(&#x27;a&#x27;);</span><br><span class="line">INSERT INTO tab_set VALUES(&#x27;A,B&#x27;);</span><br><span class="line">INSERT INTO tab_set VALUES(&#x27;a,c,d&#x27;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="日期型">日期型</h4>
<ul>
<li><strong>分类：</strong></li>
</ul>
<ol type="1">
<li><code>date</code>只保存日期；</li>
<li><code>time</code>只保存时间；</li>
<li><code>year</code>只保存年；</li>
<li><code>datetime</code>保存日期+时间；</li>
<li><code>timestamp</code>保存日期+时间；</li>
</ol>
<ul>
<li><p><strong>特点：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">			字节		范围			时区等的影响</span><br><span class="line">datetime	 8		1000——9999	       不受</span><br><span class="line">timestamp	 4	    1970-2038	        受</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tab_date(</span><br><span class="line">	t1 DATETIME,</span><br><span class="line">	t2 TIMESTAMP</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_date VALUES(NOW(),NOW());</span><br><span class="line"></span><br><span class="line">SELECT * FROM tab_date;</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#x27;time_zone&#x27;;</span><br><span class="line"></span><br><span class="line">SET time_zone=&#x27;+9:00&#x27;;</span><br></pre></td></tr></table></figure> ### 常见的约束</p></li>
<li><p><strong>含义：</strong>
一种限制，用于限制表中的数据，为了保证表中的数据的准确和可靠性。</p></li>
<li><p><strong>分类:</strong></p></li>
</ul>
<p><strong>六大约束</strong><br />
1. <code>NOT NULL</code>：非空，用于保证该字段的值不能为空<br />
比如姓名、学号等</p>
<ol start="2" type="1">
<li><p><code>DEFAULT</code>: 默认，用于保证该字段有默认值<br />
比如性别</p></li>
<li><p><code>PRIMARY KEY</code>:
主键，用于保证该字段的值具有唯一性，并且非空<br />
比如学号、员工编号等</p></li>
<li><p><code>UNIQUE</code>:
唯一，用于保证该字段的值具有唯一性，可以为空<br />
比如座位号</p></li>
<li><p><code>CHECK</code>: 检查约束【mysql中不支持】<br />
比如年龄、性别</p></li>
<li><p><code>FOREIGN KEY</code>:
外键，用于限制两个表的关系，用于保证该字段的值必须来自于主表的关联列的值<br />
在从表添加外键约束，用于引用主表中某列的值<br />
比如学生表的专业编号，员工表的部门编号，员工表的工种编号</p></li>
</ol>
<ul>
<li><strong>添加约束的时机：</strong><br />
</li>
</ul>
<ol type="1">
<li>创建表时；</li>
<li>修改表时</li>
</ol>
<p><strong>约束的添加分类：</strong></p>
<p><code>列级约束</code>：六大约束语法上都支持，但外键约束没有效果<br />
<code>表级约束</code>：除了非空、默认，其他的都支持 -
<strong>语法:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名&#123;</span><br><span class="line">	字段名 字段类型 列级约束,</span><br><span class="line">	字段名 字段类型,</span><br><span class="line">	表级约束</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure> #### 一、创建表时添加约束
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#先新建一个库</span><br><span class="line">CREATE DATABASE students;</span><br></pre></td></tr></table></figure> 1. <strong><em>添加列级约束</em></strong></p>
<ul>
<li><p><strong>语法：</strong> 直接在字段名和类型后面追加
约束类型即可。只支持：默认、非空、主键、唯一</p></li>
<li><p><strong>案例:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">USE students;</span><br><span class="line"></span><br><span class="line">DROP TABLE stuinfo;</span><br><span class="line"></span><br><span class="line">CREATE TABLE stuinfo(</span><br><span class="line">	id INT PRIMARY KEY,#主键</span><br><span class="line">	stuName VARCHAR(20) NOT NULL UNIQUE,#非空</span><br><span class="line">	gender CHAR(1) CHECK(gender=&#x27;男&#x27; OR gender =&#x27;女&#x27;),#检查</span><br><span class="line">	seat INT UNIQUE,#唯一</span><br><span class="line">	age INT DEFAULT  18,#默认约束</span><br><span class="line">	majorId INT REFERENCES major(id)#外键</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE major(</span><br><span class="line">	id INT PRIMARY KEY,</span><br><span class="line">	majorName VARCHAR(20)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#查看stuinfo中的所有索引，包括主键、外键、唯一</span><br><span class="line">SHOW INDEX FROM stuinfo;</span><br></pre></td></tr></table></figure></p></li>
</ul>
<ol start="2" type="1">
<li><strong><em>添加表级约束</em></strong><br />
</li>
</ol>
<ul>
<li><strong>语法：</strong> 在各个字段的最下面 【constraint 约束名】
约束类型(字段名) <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">TABLE IF EXISTS stuinfo;</span><br><span class="line">CREATE TABLE stuinfo(</span><br><span class="line">	id INT,</span><br><span class="line">	stuname VARCHAR(20),</span><br><span class="line">	gender CHAR(1),</span><br><span class="line">	seat INT,</span><br><span class="line">	age INT,</span><br><span class="line">	majorid INT,</span><br><span class="line">	</span><br><span class="line">	CONSTRAINT pk PRIMARY KEY(id),#主键</span><br><span class="line">	CONSTRAINT uq UNIQUE(seat),#唯一键</span><br><span class="line">	CONSTRAINT ck CHECK(gender =&#x27;男&#x27; OR gender  = &#x27;女&#x27;),#检查</span><br><span class="line">	CONSTRAINT fk_stuinfo_major FOREIGN KEY(majorid) REFERENCES major(id)#外键	</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">SHOW INDEX FROM stuinfo;</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="3" type="1">
<li><strong><em>通用的写法：★</em></strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE IF NOT EXISTS stuinfo(</span><br><span class="line">	id INT PRIMARY KEY,</span><br><span class="line">	stuname VARCHAR(20),</span><br><span class="line">	sex CHAR(1),</span><br><span class="line">	age INT DEFAULT 18,</span><br><span class="line">	seat INT UNIQUE,</span><br><span class="line">	majorid INT,</span><br><span class="line">	CONSTRAINT fk_stuinfo_major FOREIGN KEY(majorid) REFERENCES major(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table 表名(</span><br><span class="line">  	字段名 字段类型 not null,#非空</span><br><span class="line">  	字段名 字段类型 primary key,#主键</span><br><span class="line">  	字段名 字段类型 unique,#唯一</span><br><span class="line">  	字段名 字段类型 default 值,#默认</span><br><span class="line">  	constraint 约束名 foreign key(字段名) references 主表（被引用列）</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">  			   支持类型		      可以起约束名			</span><br><span class="line">列级约束		除了外键		     不可以</span><br><span class="line">表级约束		除了非空和默认	  可以，但对主键无效</span><br><span class="line">  </span><br><span class="line">列级约束可以在一个字段上追加多个，中间用空格隔开，没有顺序要求</span><br></pre></td></tr></table></figure></li>
<li><strong><em>主键和唯一的区别:</em></strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">		保证唯一性  是否允许为空    一个表中可以有多少个   是否允许组合</span><br><span class="line">主键		√				×			至多有1个           √，但不推荐</span><br><span class="line">唯一		√				√			可以有多个          √，但不推荐</span><br></pre></td></tr></table></figure> ####
二、修改表时添加约束</li>
</ol>
<ul>
<li><strong>语法：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、添加列级约束</span><br><span class="line">alter table 表名 modify column 字段名 字段类型 新约束;</span><br><span class="line"></span><br><span class="line">2、添加表级约束</span><br><span class="line">alter table 表名 add 【constraint 约束名】 约束类型(字段名) 【外键的引用】;</span><br></pre></td></tr></table></figure></li>
<li><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS stuinfo;</span><br><span class="line">CREATE TABLE stuinfo(</span><br><span class="line">	id INT,</span><br><span class="line">	stuname VARCHAR(20),</span><br><span class="line">	gender CHAR(1),</span><br><span class="line">	seat INT,</span><br><span class="line">	age INT,</span><br><span class="line">	majorid INT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">DESC stuinfo;</span><br><span class="line">#1.添加非空约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN stuname VARCHAR(20)  NOT NULL;</span><br><span class="line"></span><br><span class="line">#2.添加默认约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN age INT DEFAULT 18;</span><br><span class="line"></span><br><span class="line">#3.添加主键</span><br><span class="line">    #①列级约束</span><br><span class="line">    ALTER TABLE stuinfo MODIFY COLUMN id INT PRIMARY KEY;</span><br><span class="line">    #②表级约束</span><br><span class="line">    ALTER TABLE stuinfo ADD PRIMARY KEY(id);</span><br><span class="line"></span><br><span class="line">#4.添加唯一</span><br><span class="line">    #①列级约束</span><br><span class="line">    ALTER TABLE stuinfo MODIFY COLUMN seat INT UNIQUE;</span><br><span class="line">    #②表级约束</span><br><span class="line">    ALTER TABLE stuinfo ADD UNIQUE(seat);</span><br><span class="line"></span><br><span class="line">#5.添加外键</span><br><span class="line">ALTER TABLE stuinfo ADD CONSTRAINT fk_stuinfo_major FOREIGN KEY(majorid) REFERENCES major(id); </span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="三修改表时删除约束">三、修改表时删除约束</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#1.删除非空约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN stuname VARCHAR(20) NULL;</span><br><span class="line"></span><br><span class="line">#2.删除默认约束</span><br><span class="line">ALTER TABLE stuinfo MODIFY COLUMN age INT ;</span><br><span class="line"></span><br><span class="line">#3.删除主键</span><br><span class="line">ALTER TABLE stuinfo DROP PRIMARY KEY;</span><br><span class="line"></span><br><span class="line">#4.删除唯一</span><br><span class="line">ALTER TABLE stuinfo DROP INDEX seat;</span><br><span class="line"></span><br><span class="line">#5.删除外键</span><br><span class="line">ALTER TABLE stuinfo DROP FOREIGN KEY fk_stuinfo_major;</span><br><span class="line"></span><br><span class="line">SHOW INDEX FROM stuinfo;</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>修改表时添加或删除约束的具体语法总结:</strong>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1、非空</span><br><span class="line">添加非空</span><br><span class="line">alter table 表名 modify column 字段名 字段类型 not null;</span><br><span class="line">删除非空</span><br><span class="line">alter table 表名 modify column 字段名 字段类型 ;</span><br><span class="line"></span><br><span class="line">2、默认</span><br><span class="line">添加默认</span><br><span class="line">alter table 表名 modify column 字段名 字段类型 default 值;</span><br><span class="line">删除默认</span><br><span class="line">alter table 表名 modify column 字段名 字段类型 ;</span><br><span class="line"></span><br><span class="line">3、主键</span><br><span class="line">添加主键</span><br><span class="line">alter table 表名 add【 constraint 约束名】 primary key(字段名);</span><br><span class="line">删除主键</span><br><span class="line">alter table 表名 drop primary key;</span><br><span class="line"></span><br><span class="line">4、唯一</span><br><span class="line">添加唯一</span><br><span class="line">alter table 表名 add【 constraint 约束名】 unique(字段名);</span><br><span class="line">删除唯一</span><br><span class="line">alter table 表名 drop index 索引名;</span><br><span class="line"></span><br><span class="line">5、外键</span><br><span class="line">添加外键</span><br><span class="line">alter table 表名 add【 constraint 约束名】 foreign key(字段名) references 主表（被引用列）;</span><br><span class="line">删除外键</span><br><span class="line">alter table 表名 drop foreign key 约束名;</span><br></pre></td></tr></table></figure> #### 四、自增长列(标识列)</p></li>
<li><p><strong>含义：</strong>
可以不用手动的插入值，系统提供默认的序列值</p></li>
<li><p><strong>特点:</strong><br />
</p></li>
</ul>
<ol type="1">
<li>不用手动插入值，可以自动提供序列值，默认从1开始，步长为1<br />
auto_increment_increment<br />
如果要更改起始值：手动插入值<br />
如果要更改步长：更改系统变量<br />
set auto_increment_increment=值;</li>
<li>一个表至多有一个自增长列</li>
<li>自增长列只能支持数值型</li>
<li>自增长列必须为一个key</li>
</ol>
<ul>
<li><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#一、创建表时设置标识列</span><br><span class="line">DROP TABLE IF EXISTS tab_identity;</span><br><span class="line"></span><br><span class="line">CREATE TABLE tab_identity(</span><br><span class="line">	id INT  ,</span><br><span class="line">	NAME FLOAT UNIQUE AUTO_INCREMENT,</span><br><span class="line">	seat INT </span><br><span class="line">) TRUNCATE TABLE tab_identity;</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_identity(id,NAME) VALUES(NULL,&#x27;john&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO tab_identity(NAME) VALUES(&#x27;lucy&#x27;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM tab_identity;</span><br><span class="line"></span><br><span class="line">SHOW VARIABLES LIKE &#x27;%auto_increment%&#x27;;</span><br><span class="line"></span><br><span class="line">SET auto_increment_increment=3;</span><br></pre></td></tr></table></figure></li>
<li><strong>语法总结:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">一、创建表时设置自增长列</span><br><span class="line">create table 表(</span><br><span class="line">	字段名 字段类型 约束 auto_increment</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">二、修改表时设置自增长列</span><br><span class="line">alter table 表 modify column 字段名 字段类型 约束 auto_increment;</span><br><span class="line"></span><br><span class="line">三、删除自增长列</span><br><span class="line">alter table 表 modify column 字段名 字段类型 约束;</span><br></pre></td></tr></table></figure> --- ## TCL语言 ###
Transaction Control Language 事务控制语言 #### 事务：<br />
一个或一组sql语句组成一个执行单元，这个执行单元要么全部执行，要么全部不执行。
#### 事务的特性(ACID):</li>
</ul>
<ol type="1">
<li><code>原子性</code>：一个事务不可再分割，要么都执行要么都不执行</li>
<li><code>一致性</code>：一个事务执行会使数据从一个一致状态切换到另外一个一致状态</li>
<li><code>隔离性</code>：一个事务的执行不受其他事务的干扰</li>
<li><code>持久性</code>：一个事务一旦提交，则会永久的改变数据库的数据.</li>
</ol>
<h3 id="事务的使用步骤">事务的使用步骤 ★</h3>
<ul>
<li><p><strong>隐式（自动）事务：</strong>
没有明显的开启和结束，本身就是一条事务可以自动提交，比如insert、update、delete</p></li>
<li><p><strong>显式事务：</strong>
事务具有明显的开启和结束的标记；前提：必须先设置自动提交功能为禁用
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">开启事务的语句;</span><br><span class="line">update 表 set 张三丰的余额=500 where name=&#x27;张三丰&#x27;</span><br><span class="line"></span><br><span class="line">update 表 set 郭襄的余额=1500 where name=&#x27;郭襄&#x27; </span><br><span class="line">结束事务的语句;</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>具体步骤：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">步骤1：开启事务</span><br><span class="line">set autocommit=0;</span><br><span class="line">start transaction;可选的</span><br><span class="line"></span><br><span class="line">步骤2：编写事务中的sql语句(select insert update delete)</span><br><span class="line">语句1;</span><br><span class="line">语句2;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">步骤3：结束事务</span><br><span class="line">commit;提交事务</span><br><span class="line">rollback;回滚事务</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &#x27;autocommit&#x27;;</span><br><span class="line">SHOW ENGINES;</span><br><span class="line"></span><br><span class="line">#1.演示事务的使用步骤</span><br><span class="line">DROP TABLE IF EXISTS account;</span><br><span class="line">CREATE TABLE account(</span><br><span class="line">	id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	username VARCHAR(20),</span><br><span class="line">	balance DOUBLE</span><br><span class="line">);</span><br><span class="line">INSERT INTO account(username,balance)</span><br><span class="line">VALUES(&#x27;张无忌&#x27;,1000),(&#x27;赵敏&#x27;,1000);</span><br><span class="line"></span><br><span class="line">#开启事务</span><br><span class="line">SET autocommit=0;</span><br><span class="line">START TRANSACTION;</span><br><span class="line">#编写一组事务的语句</span><br><span class="line">UPDATE account SET balance = 1000 WHERE username=&#x27;张无忌&#x27;;</span><br><span class="line">UPDATE account SET balance = 1000 WHERE username=&#x27;赵敏&#x27;;</span><br><span class="line"></span><br><span class="line">#结束事务</span><br><span class="line">ROLLBACK;</span><br><span class="line">#commit;</span><br><span class="line"></span><br><span class="line">SELECT * FROM account;</span><br></pre></td></tr></table></figure> ### 并发事务</p></li>
</ul>
<ol type="1">
<li><p>事务的并发问题是如何发生的？<br />
多个事务同时操作 同一个数据库的相同数据时</p></li>
<li><p>并发问题都有哪些？<br />
对于同时运行的多个事务, 当这些事务访问数据库中相同的数据时,
如果没有采取必要的隔离机制, 就会导致各种并发问题：<br />
<code>脏读</code>：一个事务读取了其他事务还没有提交的数据，读到的是其他事务“更新”的数据；
<code>不可重复读</code>：一个事务多次读取，结果不一样；<br />
<code>幻读</code>：一个事务读取了其他事务还没有提交的数据，只是读到的是其他事务“插入”的数据。<br />
<code>数据库事务的隔离性</code>:
数据库系统必须具有隔离并发运行各个事务的能力, 使它们不会相互影响,
避免各种并发问题.<br />
一个事务与其他事务隔离的程度称为隔离级别. 数据库规定了多种事务隔离级别,
不同隔离级别对应不同的干扰程度, 隔离级别越高, 数据一致性就越好,
但并发性越弱</p></li>
<li><p>如何解决并发问题？<br />
通过设置隔离级别来解决并发问题</p></li>
<li><p>隔离级别: <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">							脏读			不可重复读		  幻读</span><br><span class="line">read uncommitted:读未提交     ×                ×              ×        </span><br><span class="line">read committed：读已提交      √                ×              ×</span><br><span class="line">repeatable read：可重复读     √                √              ×</span><br><span class="line">serializable：串行化          √                √              √</span><br></pre></td></tr></table></figure> Oracle 支持的2 种事务隔离级别：READ
COMMITED, SERIALIZABLE。Oracle 默认的事务隔离级别为: READ COMMITED<br />
Mysql 支持4 种事务隔离级别. Mysql 默认的事务隔离级别为: REPEATABLE READ
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">查看隔离级别</span><br><span class="line">select @@tx_isolation;</span><br><span class="line">设置隔离级别</span><br><span class="line">set session|global transaction isolation level 隔离级别;</span><br><span class="line"></span><br><span class="line">#2.演示事务对于delete和truncate的处理的区别</span><br><span class="line">SET autocommit=0;</span><br><span class="line">START TRANSACTION;</span><br><span class="line"></span><br><span class="line">DELETE FROM account;</span><br><span class="line">ROLLBACK;</span><br></pre></td></tr></table></figure> ### 回滚点的演示 savepoint 节点名;设置保存点
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#3.演示savepoint 的使用</span><br><span class="line">SET autocommit=0;</span><br><span class="line"></span><br><span class="line">START TRANSACTION;</span><br><span class="line">DELETE FROM account WHERE id=25;</span><br><span class="line">SAVEPOINT a;#设置保存点</span><br><span class="line">DELETE FROM account WHERE id=28;</span><br><span class="line">ROLLBACK TO a;#回滚到保存点</span><br><span class="line"></span><br><span class="line">SELECT * FROM account;</span><br></pre></td></tr></table></figure> --- ## 其他 ### 视图 #### 什么是视图？
<strong>视图：</strong>
虚拟表,和普通表一样使用。mysql5.1版本出现的新特性，是通过表动态生成的数据。</p></li>
</ol>
<p><strong>应用场景：</strong> 多个地方用到同样的查询结果<br />
该查询结果使用的sql语句较复杂</p>
<p><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT stuname,majorname FROM stuinfo s</span><br><span class="line">INNER JOIN major m ON s.`majorid`= m.`id`</span><br><span class="line">WHERE s.`stuname` LIKE &#x27;张%&#x27;;</span><br><span class="line"></span><br><span class="line">CREATE VIEW v1 AS</span><br><span class="line">SELECT stuname,majorname</span><br><span class="line">FROM stuinfo s</span><br><span class="line">INNER JOIN major m ON s.`majorid`= m.`id`;</span><br><span class="line"></span><br><span class="line">SELECT * FROM v1 WHERE stuname LIKE &#x27;张%&#x27;;</span><br></pre></td></tr></table></figure> #### 视图的创建 -
<strong>语法：</strong> create view 视图名 as 查询语句; -
<strong>案例:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">USE myemployees;</span><br><span class="line"></span><br><span class="line">#1.查询姓名中包含a字符的员工名、部门名和工种信息</span><br><span class="line">    #①创建</span><br><span class="line">    CREATE VIEW myv1 AS</span><br><span class="line">    SELECT last_name,department_name,job_title</span><br><span class="line">    FROM employees e</span><br><span class="line">    JOIN departments d ON e.department_id  = d.department_id</span><br><span class="line">    JOIN jobs j ON j.job_id  = e.job_id;</span><br><span class="line"></span><br><span class="line">    #②使用</span><br><span class="line">    SELECT * FROM myv1 WHERE last_name LIKE &#x27;%a%&#x27;;</span><br><span class="line"></span><br><span class="line">#2.查询各部门的平均工资级别</span><br><span class="line">    #①创建视图查看每个部门的平均工资</span><br><span class="line">    CREATE VIEW myv2 AS</span><br><span class="line">    SELECT AVG(salary) ag,department_id</span><br><span class="line">    FROM employees GROUP BY department_id;</span><br><span class="line"></span><br><span class="line">    #②使用</span><br><span class="line">    SELECT myv2.`ag`,g.grade_level FROM myv2</span><br><span class="line">    JOIN job_grades g</span><br><span class="line">    ON myv2.`ag` BETWEEN g.`lowest_sal` AND g.`highest_sal`;</span><br><span class="line"></span><br><span class="line">#3.查询平均工资最低的部门信息</span><br><span class="line">SELECT * FROM myv2 ORDER BY ag LIMIT 1;</span><br><span class="line"></span><br><span class="line">#4.查询平均工资最低的部门名和工资</span><br><span class="line">    CREATE VIEW myv3 AS</span><br><span class="line">    SELECT * FROM myv2 ORDER BY ag LIMIT 1;</span><br><span class="line"></span><br><span class="line">    SELECT d.*,m.ag FROM myv3 m</span><br><span class="line">    JOIN departments d</span><br><span class="line">    ON m.`department_id`=d.`department_id`;</span><br></pre></td></tr></table></figure> - <strong>视图的好处:</strong> 1.
重用sql语句 2. 简化复杂的sql操作，不必知道它的查询细节 3.
保护数据，提高安全性</p>
<h4 id="视图的修改">视图的修改</h4>
<ul>
<li><p><strong>语法:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">方式一：</span><br><span class="line">create or replace view 视图名 as 查询语句;</span><br><span class="line">方式二：</span><br><span class="line">alter view 视图名 as 查询语句;</span><br></pre></td></tr></table></figure></p></li>
<li><p><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#方式一：</span><br><span class="line">/*</span><br><span class="line">create or replace view  视图名 as 查询语句;</span><br><span class="line">*/</span><br><span class="line">SELECT * FROM myv3 </span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE VIEW myv3 AS</span><br><span class="line">SELECT AVG(salary),job_id</span><br><span class="line">FROM employees GROUP BY job_id;</span><br><span class="line"></span><br><span class="line">#方式二：</span><br><span class="line">/*</span><br><span class="line">语法：</span><br><span class="line">alter view 视图名 as 查询语句;</span><br><span class="line">*/</span><br><span class="line">ALTER VIEW myv3 AS SELECT * FROM employees;</span><br></pre></td></tr></table></figure> #### 视图的删除</p></li>
<li><p>用户可以一次删除一个或者多个视图，前提是必须有该视图的drop权限。</p></li>
<li><p><strong>语法：</strong> drop view 视图1，视图2,…;</p></li>
<li><p><strong>案例:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">语法：drop view 视图名,视图名,...;</span><br><span class="line">*/</span><br><span class="line">DROP VIEW emp_v1,emp_v2,myv3;</span><br></pre></td></tr></table></figure> #### 视图的查看</p></li>
<li><p><strong>语法:</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">desc 视图名;</span><br><span class="line">show create view 视图名;</span><br></pre></td></tr></table></figure> #### 视图的更新</p></li>
</ul>
<ol type="1">
<li>插入：insert</li>
<li>修改：update</li>
<li>删除：delete</li>
<li>查看：select <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE VIEW myv1</span><br><span class="line">AS</span><br><span class="line">SELECT last_name,email,salary*12*(1+IFNULL(commission_pct,0)) &quot;annual salary&quot;</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE VIEW myv1</span><br><span class="line">AS</span><br><span class="line">SELECT last_name,email</span><br><span class="line">FROM employees;</span><br><span class="line"></span><br><span class="line">SELECT * FROM myv1;</span><br><span class="line">SELECT * FROM employees;</span><br><span class="line">#1.插入</span><br><span class="line"></span><br><span class="line">INSERT INTO myv1 VALUES(&#x27;张飞&#x27;,&#x27;zf@qq.com&#x27;);</span><br><span class="line"></span><br><span class="line">#2.修改</span><br><span class="line">UPDATE myv1 SET last_name = &#x27;张无忌&#x27; WHERE last_name=&#x27;张飞&#x27;;</span><br><span class="line"></span><br><span class="line">#3.删除</span><br><span class="line">DELETE FROM myv1 WHERE last_name = &#x27;张无忌&#x27;;</span><br></pre></td></tr></table></figure> <strong>注意：</strong>
视图一般用于查询的，而不是更新的，所以具备以下特点的视图都不允许更新:<br />
</li>
<li>包含以下关键字的sql语句：分组函数、distinct、group
by、having、union或者union all<br />
</li>
<li>常量视图<br />
</li>
<li>Select中包含子查询<br />
</li>
<li>join<br />
</li>
<li>from一个不能更新的视图<br />
</li>
<li>where子句的子查询引用了from子句中的表<br />
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">#具备以下特点的视图不允许更新</span><br><span class="line">#①包含以下关键字的sql语句：分组函数、distinct、group  by、having、union或者union all</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE VIEW myv1</span><br><span class="line">AS</span><br><span class="line">SELECT MAX(salary) m,department_id</span><br><span class="line">FROM employees</span><br><span class="line">GROUP BY department_id;</span><br><span class="line"></span><br><span class="line">SELECT * FROM myv1;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line">UPDATE myv1 SET m=9000 WHERE department_id=10;</span><br><span class="line"></span><br><span class="line">#②常量视图</span><br><span class="line">CREATE OR REPLACE VIEW myv2</span><br><span class="line">AS</span><br><span class="line">SELECT &#x27;john&#x27; NAME;</span><br><span class="line"></span><br><span class="line">SELECT * FROM myv2;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line">UPDATE myv2 SET NAME=&#x27;lucy&#x27;;</span><br><span class="line"></span><br><span class="line">#③Select中包含子查询</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE VIEW myv3</span><br><span class="line">AS</span><br><span class="line">SELECT department_id,(SELECT MAX(salary) FROM employees) 最高工资</span><br><span class="line">FROM departments;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line">SELECT * FROM myv3;</span><br><span class="line">UPDATE myv3 SET 最高工资=100000;</span><br><span class="line"></span><br><span class="line">#④join</span><br><span class="line">CREATE OR REPLACE VIEW myv4</span><br><span class="line">AS</span><br><span class="line">SELECT last_name,department_name</span><br><span class="line">FROM employees e</span><br><span class="line">JOIN departments d</span><br><span class="line">ON e.department_id  = d.department_id;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line">SELECT * FROM myv4;</span><br><span class="line">UPDATE myv4 SET last_name  = &#x27;张飞&#x27; WHERE last_name=&#x27;Whalen&#x27;;</span><br><span class="line">INSERT INTO myv4 VALUES(&#x27;陈真&#x27;,&#x27;xxxx&#x27;);</span><br><span class="line"></span><br><span class="line">#⑤from一个不能更新的视图</span><br><span class="line">CREATE OR REPLACE VIEW myv5</span><br><span class="line">AS SELECT * FROM myv3;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line">SELECT * FROM myv5;</span><br><span class="line">UPDATE myv5 SET 最高工资=10000 WHERE department_id=60;</span><br><span class="line"></span><br><span class="line">#⑥where子句的子查询引用了from子句中的表</span><br><span class="line"></span><br><span class="line">CREATE OR REPLACE VIEW myv6</span><br><span class="line">AS</span><br><span class="line">SELECT last_name,email,salary</span><br><span class="line">FROM employees</span><br><span class="line">WHERE employee_id IN(</span><br><span class="line">	SELECT  manager_id</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE manager_id IS NOT NULL</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line">SELECT * FROM myv6;</span><br><span class="line">UPDATE myv6 SET salary=10000 WHERE last_name = &#x27;k_ing&#x27;;</span><br></pre></td></tr></table></figure> #### 视图和表的对比 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">		关键字		  是否占用物理空间			使用</span><br><span class="line">视图	view		占用较小，只保存sql逻辑	一般用于查询</span><br><span class="line">表	    table		保存实际的数据			  增删改查</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="变量">变量</h3>
<h4 id="变量的介绍">变量的介绍</h4>
<p><strong>系统变量</strong>： 1. 全局变量 2. 会话变量
<strong>自定义变量</strong>： 1. 用户变量 2. 局部变量</p>
<h4 id="系统变量的介绍和语法">系统变量的介绍和语法</h4>
<ul>
<li><p><strong>说明：</strong>
变量由系统定义，不是用户定义，属于服务器层面</p></li>
<li><p><strong>注意：</strong>
全局变量需要添加global关键字，会话变量需要添加session关键字，如果不写，默认会话级别</p></li>
<li><p><strong>使用步骤：</strong></p></li>
</ul>
<ol type="1">
<li><strong><em>查看所有系统变量:</em></strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global|【session】variables;</span><br></pre></td></tr></table></figure></li>
<li><strong><em>查看满足条件的部分系统变量:</em></strong>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global|【session】 variables like &#x27;%char%&#x27;;</span><br></pre></td></tr></table></figure></li>
<li><strong><em>查看指定的系统变量的值:</em></strong>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@global|【session】系统变量名;</span><br></pre></td></tr></table></figure></li>
<li><strong><em>为某个系统变量赋值:</em></strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">方式一：</span><br><span class="line">set global|【session】系统变量名=值;</span><br><span class="line">方式二：</span><br><span class="line">set @@global|【session】系统变量名=值;</span><br></pre></td></tr></table></figure> ####
全局变量的演示 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#1》全局变量</span><br><span class="line">/*</span><br><span class="line">作用域：针对于所有会话（连接）有效，但不能跨重启</span><br><span class="line">*/</span><br><span class="line">#①查看所有全局变量</span><br><span class="line">SHOW GLOBAL VARIABLES;</span><br><span class="line">#②查看满足条件的部分系统变量</span><br><span class="line">SHOW GLOBAL VARIABLES LIKE &#x27;%char%&#x27;;</span><br><span class="line">#③查看指定的系统变量的值</span><br><span class="line">SELECT @@global.autocommit;</span><br><span class="line">#④为某个系统变量赋值</span><br><span class="line">SET @@global.autocommit=0;</span><br><span class="line">SET GLOBAL autocommit=0;</span><br></pre></td></tr></table></figure> #### 会话变量的演示 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#2》会话变量</span><br><span class="line">/*</span><br><span class="line">作用域：针对于当前会话（连接）有效</span><br><span class="line">*/</span><br><span class="line">#①查看所有会话变量</span><br><span class="line">SHOW SESSION VARIABLES;</span><br><span class="line">#②查看满足条件的部分会话变量</span><br><span class="line">SHOW SESSION VARIABLES LIKE &#x27;%char%&#x27;;</span><br><span class="line">#③查看指定的会话变量的值</span><br><span class="line">SELECT @@autocommit;</span><br><span class="line">SELECT @@session.tx_isolation;</span><br><span class="line">#④为某个会话变量赋值</span><br><span class="line">SET @@session.tx_isolation=&#x27;read-uncommitted&#x27;;</span><br><span class="line">SET SESSION tx_isolation=&#x27;read-committed&#x27;;</span><br></pre></td></tr></table></figure> ####
自定义变量—用户变量 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#二、自定义变量</span><br><span class="line">/*</span><br><span class="line">说明：变量由用户自定义，而不是系统提供的</span><br><span class="line">使用步骤：</span><br><span class="line">1、声明</span><br><span class="line">2、赋值</span><br><span class="line">3、使用（查看、比较、运算等）</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">#1》用户变量</span><br><span class="line">/*</span><br><span class="line">作用域：针对于当前会话（连接）有效，作用域同于会话变量</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">#赋值操作符：=或:=</span><br><span class="line">#①声明并初始化</span><br><span class="line">SET @变量名=值;</span><br><span class="line">SET @变量名:=值;</span><br><span class="line">SELECT @变量名:=值;</span><br><span class="line"></span><br><span class="line">#②赋值（更新变量的值）</span><br><span class="line">#方式一：</span><br><span class="line">	SET @变量名=值;</span><br><span class="line">	SET @变量名:=值;</span><br><span class="line">	SELECT @变量名:=值;</span><br><span class="line">#方式二：</span><br><span class="line">	SELECT 字段 INTO @变量名</span><br><span class="line">	FROM 表;</span><br><span class="line">#③使用（查看变量的值）</span><br><span class="line">SELECT @变量名;</span><br></pre></td></tr></table></figure> #### 自定义变量—局部变量
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#2》局部变量</span><br><span class="line">/*</span><br><span class="line">作用域：仅仅在定义它的begin end块中有效</span><br><span class="line">应用在 begin end中的第一句话</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">#①声明</span><br><span class="line">DECLARE 变量名 类型;</span><br><span class="line">DECLARE 变量名 类型 【DEFAULT 值】;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#②赋值（更新变量的值）</span><br><span class="line"></span><br><span class="line">#方式一：</span><br><span class="line">	SET 局部变量名=值;</span><br><span class="line">	SET 局部变量名:=值;</span><br><span class="line">	SELECT 局部变量名:=值;</span><br><span class="line">#方式二：</span><br><span class="line">	SELECT 字段 INTO 具备变量名</span><br><span class="line">	FROM 表;</span><br><span class="line">#③使用（查看变量的值）</span><br><span class="line">SELECT 局部变量名;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：声明两个变量，求和并打印</span><br><span class="line">#用户变量</span><br><span class="line">SET @m=1;</span><br><span class="line">SET @n=1;</span><br><span class="line">SET @sum=@m+@n;</span><br><span class="line">SELECT @sum;</span><br><span class="line"></span><br><span class="line">#局部变量</span><br><span class="line">DECLARE m INT DEFAULT 1;</span><br><span class="line">DECLARE n INT DEFAULT 1;</span><br><span class="line">DECLARE SUM INT;</span><br><span class="line">SET SUM=m+n;</span><br><span class="line">SELECT SUM;</span><br></pre></td></tr></table></figure> #### 用户变量和局部变量的对比 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">		作用域			定义位置		语法</span><br><span class="line">用户变量	当前会话		会话的任何地方		加@符号，不用指定类型</span><br><span class="line">局部变量	定义它的BEGIN END中 	BEGIN END的第一句话	一般不用加@,需要指定类型</span><br></pre></td></tr></table></figure> ###
存储过程和函数</li>
</ol>
<ul>
<li><strong>说明：</strong>
都类似于java中的方法，将一组完成特定功能的逻辑语句包装起来，对外暴露名字<br />
</li>
<li><strong>好处:</strong></li>
</ul>
<ol type="1">
<li>提高代码的重用性</li>
<li>简化操作</li>
<li>减少了编译次数并且减少了和数据库服务器的连接次数，提高了效率 ####
存储过程</li>
</ol>
<ul>
<li><strong>含义：</strong>
一组预先编译好的SQL语句的集合，理解成批处理语句</li>
</ul>
<p><strong>一、创建语法</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE 存储过程名(参数列表)</span><br><span class="line">BEGIN</span><br><span class="line">	存储过程体（一组合法的SQL语句）</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">注意：</span><br><span class="line">1、参数列表包含三部分</span><br><span class="line">参数模式  参数名  参数类型</span><br><span class="line">举例：</span><br><span class="line">in stuname varchar(20)</span><br><span class="line"></span><br><span class="line">参数模式：</span><br><span class="line">in：该参数可以作为输入，也就是该参数需要调用方传入值</span><br><span class="line">out：该参数可以作为输出，也就是该参数可以作为返回值</span><br><span class="line">inout：该参数既可以作为输入又可以作为输出，也就是该参数既需要传入值，又可以返回值</span><br><span class="line"></span><br><span class="line">2、如果存储过程体仅仅只有一句话，begin end可以省略</span><br><span class="line">存储过程体中的每条sql语句的结尾要求必须加分号。</span><br><span class="line">存储过程的结尾可以使用 delimiter 重新设置</span><br><span class="line">语法：</span><br><span class="line">delimiter 结束标记</span><br><span class="line">案例：</span><br><span class="line">delimiter $</span><br></pre></td></tr></table></figure>
<strong>二、调用语法</strong></p>
<ul>
<li><strong>语法：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CALL 存储过程名(实参列表);</span><br><span class="line"></span><br><span class="line">举例：</span><br><span class="line">调用in模式的参数：call sp1（‘值’）;</span><br><span class="line">调用out模式的参数：set @name; call sp1(@name);select @name;</span><br><span class="line">调用inout模式的参数：set @name=值; call sp1(@name); select @name;</span><br></pre></td></tr></table></figure></li>
<li><strong>案例：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">#1.空参列表</span><br><span class="line">#案例：插入到admin表中五条记录</span><br><span class="line"></span><br><span class="line">SELECT * FROM admin;</span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br><span class="line">CREATE PROCEDURE myp1()</span><br><span class="line">BEGIN</span><br><span class="line">	INSERT INTO admin(username,`password`) </span><br><span class="line">	VALUES(&#x27;john1&#x27;,&#x27;0000&#x27;),(&#x27;lily&#x27;,&#x27;0000&#x27;),(&#x27;rose&#x27;,&#x27;0000&#x27;),(&#x27;jack&#x27;,&#x27;0000&#x27;),(&#x27;tom&#x27;,&#x27;0000&#x27;);</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line">CALL myp1()$</span><br><span class="line"></span><br><span class="line">#2.创建带in模式参数的存储过程</span><br><span class="line"></span><br><span class="line">#案例1：创建存储过程实现 根据女神名，查询对应的男神信息</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE myp2(IN beautyName VARCHAR(20))</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT bo.*</span><br><span class="line">	FROM boys bo</span><br><span class="line">	RIGHT JOIN beauty b ON bo.id = b.boyfriend_id</span><br><span class="line">	WHERE b.name=beautyName;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line">CALL myp2(&#x27;柳岩&#x27;)$</span><br><span class="line"></span><br><span class="line">#案例2 ：创建存储过程实现，用户是否登录成功</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE myp3(IN username VARCHAR(20),IN PASSWORD VARCHAR(20))</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE result VARBINARY(20) DEFAULT &#x27;&#x27;;#声明并初始化</span><br><span class="line">	</span><br><span class="line">	SELECT COUNT(*) INTO result#赋值</span><br><span class="line">	FROM admin</span><br><span class="line">	WHERE admin.username = username</span><br><span class="line">	AND admin.password = PASSWORD;</span><br><span class="line">	</span><br><span class="line">	SELECT result;#使用</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">CALL myp3(&#x27;张飞&#x27;,&#x27;8888&#x27;)$</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE myp4(IN username VARCHAR(20),IN PASSWORD VARCHAR(20))</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE result INT DEFAULT 0;#声明并初始化</span><br><span class="line">	</span><br><span class="line">	SELECT COUNT(*) INTO result#赋值</span><br><span class="line">	FROM admin</span><br><span class="line">	WHERE admin.username = username</span><br><span class="line">	AND admin.password = PASSWORD;</span><br><span class="line">	</span><br><span class="line">	SELECT IF(result&gt;0,&#x27;成功&#x27;,&#x27;失败&#x27;);#使用</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line">CALL myp4(&#x27;张飞&#x27;,&#x27;8888&#x27;)$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#3.创建out 模式参数的存储过程</span><br><span class="line">#案例1：根据输入的女神名，返回对应的男神名</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE myp6(IN beautyName VARCHAR(20),OUT boyName VARCHAR(20))</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT bo.boyname INTO boyname</span><br><span class="line">	FROM boys bo</span><br><span class="line">	RIGHT JOIN</span><br><span class="line">	beauty b ON b.boyfriend_id = bo.id</span><br><span class="line">	WHERE b.name=beautyName ;</span><br><span class="line">	</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">#案例2：根据输入的女神名，返回对应的男神名和魅力值</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE myp7(IN beautyName VARCHAR(20),OUT boyName VARCHAR(20),OUT usercp INT) </span><br><span class="line">BEGIN</span><br><span class="line">	SELECT boys.boyname ,boys.usercp INTO boyname,usercp</span><br><span class="line">	FROM boys </span><br><span class="line">	RIGHT JOIN</span><br><span class="line">	beauty b ON b.boyfriend_id = boys.id</span><br><span class="line">	WHERE b.name=beautyName ;</span><br><span class="line">	</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line">CALL myp7(&#x27;小昭&#x27;,@name,@cp)$</span><br><span class="line">SELECT @name,@cp$</span><br><span class="line"></span><br><span class="line">#4.创建带inout模式参数的存储过程</span><br><span class="line">#案例1：传入a和b两个值，最终a和b都翻倍并返回</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE myp8(INOUT a INT ,INOUT b INT)</span><br><span class="line">BEGIN</span><br><span class="line">	SET a=a*2;</span><br><span class="line">	SET b=b*2;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line">SET @m=10$</span><br><span class="line">SET @n=20$</span><br><span class="line">CALL myp8(@m,@n)$</span><br><span class="line">SELECT @m,@n$</span><br></pre></td></tr></table></figure> <strong>三、查看语法</strong>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">show create procedure 存储过程名;</span><br><span class="line"></span><br><span class="line">案例</span><br><span class="line">DESC myp2;×</span><br><span class="line">SHOW CREATE PROCEDURE  myp2;</span><br></pre></td></tr></table></figure> <strong>四、删除语法</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">drop procedure 存储过程名;</span><br><span class="line"></span><br><span class="line">案例:</span><br><span class="line">DROP PROCEDURE p1;</span><br><span class="line">DROP PROCEDURE p2,p3;#×</span><br></pre></td></tr></table></figure> #### 函数
<strong>含义：</strong>
一组预先编译好的SQL语句的集合，理解成批处理语句</li>
</ul>
<p><strong>区别：</strong></p>
<ol type="1">
<li><strong><em>存储过程：</em></strong>
可以有0个返回，也可以有多个返回，适合做批量插入、批量更新；</li>
<li><strong><em>函数：</em></strong> 有且仅有1
个返回，适合做处理数据后返回一个结果。</li>
</ol>
<p><strong>一、创建语法</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CREATE FUNCTION 函数名(参数列表) RETURNS 返回类型</span><br><span class="line">BEGIN</span><br><span class="line">	函数体</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">注意：</span><br><span class="line">1.参数列表 包含两部分：</span><br><span class="line">参数名 参数类型</span><br><span class="line">2.函数体：肯定会有return语句，如果没有会报错</span><br><span class="line">如果return语句没有放在函数体的最后也不报错，但不建议</span><br><span class="line"></span><br><span class="line">return 值;</span><br><span class="line">3.函数体中仅有一句话，则可以省略begin end</span><br><span class="line">4.使用 delimiter语句设置结束标记</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br></pre></td></tr></table></figure>
<strong>二、调用语法</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">SELECT 函数名(参数列表);</span><br><span class="line">案例</span><br><span class="line">use employees $</span><br><span class="line">#1.无参有返回</span><br><span class="line">#案例：返回公司的员工个数</span><br><span class="line">CREATE FUNCTION myf1() RETURNS INT</span><br><span class="line">BEGIN	</span><br><span class="line">	DECLARE c INT DEFAULT 0;</span><br><span class="line">	SELECT COUNT(*) INTO c</span><br><span class="line">	FROM employees;</span><br><span class="line">	RETURN c;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">SELECT myf1()$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.有参有返回</span><br><span class="line">#案例1：根据员工名，返回它的工资</span><br><span class="line"></span><br><span class="line">CREATE FUNCTION myf2(empName VARCHAR(20)) RETURNS DOUBLE</span><br><span class="line">BEGIN</span><br><span class="line">	SET @sal=0;#定义用户变量 </span><br><span class="line">	SELECT salary INTO @sal   #赋值</span><br><span class="line">	FROM employees</span><br><span class="line">	WHERE last_name = empName;</span><br><span class="line">	</span><br><span class="line">	RETURN @sal;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">SELECT myf2(&#x27;kochhor&#x27;) $</span><br><span class="line"></span><br><span class="line">#案例2：根据部门名，返回该部门的平均工资</span><br><span class="line"></span><br><span class="line">CREATE FUNCTION myf3(deptName VARCHAR(20)) RETURNS DOUBLE</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE sal DOUBLE ;</span><br><span class="line">	SELECT AVG(salary) INTO sal</span><br><span class="line">	FROM employees e</span><br><span class="line">	JOIN departments d ON e.department_id = d.department_id</span><br><span class="line">	WHERE d.department_name=deptName;</span><br><span class="line">	RETURN sal;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">SELECT myf3(&#x27;IT&#x27;)$</span><br></pre></td></tr></table></figure>
<strong>三、查看函数</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show create function 函数名;</span><br><span class="line"></span><br><span class="line">SHOW CREATE FUNCTION myf3 $</span><br></pre></td></tr></table></figure>
<strong>四、删除函数</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">drop function 函数名;</span><br><span class="line"></span><br><span class="line">DROP FUNCTION myf3 $</span><br></pre></td></tr></table></figure> ### 流程控制结构 -
<strong>顺序结构：</strong> 程序从上往下依次执行 -
<strong>分支结构：</strong>
程序按条件进行选择执行，从两条或多条路径中选择一条执行 -
<strong>循环结构：</strong> 程序满足一定条件下，重复执行一组语句 ####
一、分支结构</p>
<ol type="1">
<li><strong><em>if函数</em></strong></li>
</ol>
<ul>
<li><code>语法</code>：if(条件,值1，值2)；</li>
<li><code>功能</code>：实现双分支；</li>
<li><code>应用</code>：可以作为表达式放在任何位置</li>
</ul>
<ol start="2" type="1">
<li><strong><em>case结构</em></strong></li>
</ol>
<ul>
<li><code>语法</code>： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">情况1：类似于switch，一般用于实现等值判断。</span><br><span class="line">语法：</span><br><span class="line">case 变量或表达式</span><br><span class="line">when 值1 then 语句1;</span><br><span class="line">when 值2 then 语句2;</span><br><span class="line">...</span><br><span class="line">else 语句n;</span><br><span class="line">end </span><br><span class="line"></span><br><span class="line">情况2：类似于多重if语句，一般用于实现区间判断。</span><br><span class="line">语法：</span><br><span class="line">case </span><br><span class="line">when 条件1 then 语句1;</span><br><span class="line">when 条件2 then 语句2;</span><br><span class="line">...</span><br><span class="line">else 语句n;</span><br><span class="line">end </span><br></pre></td></tr></table></figure></li>
<li><code>特点</code>:</li>
</ul>
<ol type="1">
<li>可以作为表达式，嵌套在其他语句中使用。<br />
</li>
<li>可以放在任何地方，BEGIN END 中或BEGIN END
的外面可以作为独立的语句去使用，只能放在BEGIN
END中如果wHEN中的值满足或条件成立，则执行对应的THzN后面的语句，并且结束CASE如果都不满足，则执行E1SE中的语句或值。<br />
</li>
<li>ELSE可以省略，如果ELSE省略了，并且所有WHEN条件都不满足，则返回NULL。</li>
</ol>
<ul>
<li><code>位置</code>:</li>
</ul>
<ol type="1">
<li>可以放在任何位置，</li>
<li>如果放在begin end 外面，作为表达式结合着其他语句使用</li>
<li>如果放在begin end 里面，一般作为独立的语句使用</li>
</ol>
<ul>
<li><code>案例</code>: <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#案例 </span><br><span class="line">#创建存储过程，根据传入的成绩，来显示等级，比如传入的成绩：90-100, 显示A，80-90，显示B，60-80，显示c，否则，显示D</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE test_case (IN score INT) </span><br><span class="line">BEGIN </span><br><span class="line">	CASE </span><br><span class="line">	WHEN score&gt;=90 AND score&lt;=100 THEN SELECT &#x27;A&#x27;; </span><br><span class="line">	WHEN score&gt;=80 THEN SELECT &#x27;B&#x27;;</span><br><span class="line">	WHEN score&gt;=60 THEN SELECT &#x27;C&#x27;; </span><br><span class="line">	ELSE SELECT &#x27;D&#x27;;</span><br><span class="line">	END CASE; </span><br><span class="line">END $</span><br><span class="line">CALL test_case(95)$</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="3" type="1">
<li><strong><em>if结构</em></strong></li>
</ol>
<ul>
<li><strong>语法：</strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if 条件1 then 语句1;</span><br><span class="line">elseif 条件2 then 语句2;</span><br><span class="line">....</span><br><span class="line">else 语句n;</span><br><span class="line">end if;</span><br></pre></td></tr></table></figure></li>
<li><strong>功能：</strong> 类似于多重if；只能应用在begin end 中
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#案例1：创建函数，实现传入成绩，如果成绩&gt;90,返回A，如果成绩&gt;80,返回B，如果成绩&gt;60,返回C，否则返回D</span><br><span class="line"></span><br><span class="line">CREATE FUNCTION test_case(score FLOAT) RETURNS CHAR</span><br><span class="line">BEGIN </span><br><span class="line">	DECLARE ch CHAR DEFAULT &#x27;A&#x27;;</span><br><span class="line">	</span><br><span class="line">	CASE </span><br><span class="line">	WHEN score&gt;90 THEN SET ch=&#x27;A&#x27;;</span><br><span class="line">	WHEN score&gt;80 THEN SET ch=&#x27;B&#x27;;</span><br><span class="line">	WHEN score&gt;60 THEN SET ch=&#x27;C&#x27;;</span><br><span class="line">	ELSE SET ch=&#x27;D&#x27;;</span><br><span class="line">	END CASE;</span><br><span class="line">	</span><br><span class="line">	RETURN ch;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">SELECT test_case(56)$</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="二循环结构">二、循环结构</h4>
<ul>
<li><p><code>位置</code>：只能放在begin end中</p></li>
<li><p><code>特点</code>：都能实现循环结构</p></li>
<li><p><code>语法</code>: <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1、while</span><br><span class="line">语法：</span><br><span class="line">【名称:】while 循环条件 do</span><br><span class="line">		循环体</span><br><span class="line">end while 【名称】;</span><br><span class="line">2、loop</span><br><span class="line">语法：</span><br><span class="line">【名称：】loop</span><br><span class="line">		循环体</span><br><span class="line">end loop 【名称】;</span><br><span class="line"></span><br><span class="line">3、repeat</span><br><span class="line">语法：</span><br><span class="line">【名称:】repeat</span><br><span class="line">		循环体</span><br><span class="line">until 结束条件 </span><br><span class="line">end repeat 【名称】;</span><br></pre></td></tr></table></figure></p></li>
<li><p><code>对比</code>:</p></li>
</ul>
<ol type="1">
<li>这三种循环都可以省略名称，但如果循环中添加了循环控制语句（leave或iterate）则必须添加名称</li>
<li><strong>loop</strong> 一般用于实现简单的死循环<br />
<strong>while</strong> 先判断后执行<br />
<strong>repeat</strong> 先执行后判断，无条件至少执行一次</li>
</ol>
<ul>
<li><code>案例</code>: <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">#1.没有添加循环控制语句</span><br><span class="line">#案例：批量插入，根据次数插入到admin表中多条记录</span><br><span class="line">USE girls$</span><br><span class="line">DROP PROCEDURE pro_while1$</span><br><span class="line">CREATE PROCEDURE pro_while1(IN insertCount INT)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i INT DEFAULT 1;</span><br><span class="line">	WHILE i&lt;=insertCount DO</span><br><span class="line">		INSERT INTO admin(username,`password`) VALUES(CONCAT(&#x27;Rose&#x27;,i),&#x27;666&#x27;);</span><br><span class="line">		SET i=i+1;</span><br><span class="line">	END WHILE;</span><br><span class="line">	</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">CALL pro_while1(158)$</span><br><span class="line"></span><br><span class="line">select * from admin $</span><br><span class="line">/*</span><br><span class="line">int i=1;</span><br><span class="line">while(i&lt;=insertcount)&#123;</span><br><span class="line">	//插入</span><br><span class="line">	i++;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">#2.添加leave语句</span><br><span class="line">#案例：批量插入，根据次数插入到admin表中多条记录，如果次数&gt;20则停止</span><br><span class="line">TRUNCATE TABLE admin$</span><br><span class="line">DROP PROCEDURE test_while1$</span><br><span class="line">CREATE PROCEDURE test_while1(IN insertCount INT)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i INT DEFAULT 1;</span><br><span class="line">	a:WHILE i&lt;=insertCount DO</span><br><span class="line">		INSERT INTO admin(username,`password`) VALUES(CONCAT(&#x27;xiaohua&#x27;,i),&#x27;0000&#x27;);</span><br><span class="line">		IF i&gt;=20 THEN LEAVE a;</span><br><span class="line">		END IF;</span><br><span class="line">		SET i=i+1;</span><br><span class="line">	END WHILE a;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">CALL test_while1(100)$</span><br><span class="line"></span><br><span class="line">select * from admin $</span><br><span class="line"></span><br><span class="line">#3.添加iterate语句</span><br><span class="line">#案例：批量插入，根据次数插入到admin表中多条记录，只插入偶数次</span><br><span class="line">TRUNCATE TABLE admin$</span><br><span class="line">DROP PROCEDURE test_while1$</span><br><span class="line">CREATE PROCEDURE test_while1(IN insertCount INT)</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE i INT DEFAULT 0;</span><br><span class="line">	a:WHILE i&lt;=insertCount DO</span><br><span class="line">		SET i=i+1;</span><br><span class="line">		IF MOD(i,2)!=0 THEN ITERATE a;</span><br><span class="line">		END IF;</span><br><span class="line">		</span><br><span class="line">		INSERT INTO admin(username,`password`) VALUES(CONCAT(&#x27;xiaohua&#x27;,i),&#x27;0000&#x27;);</span><br><span class="line">		</span><br><span class="line">	END WHILE a;</span><br><span class="line">END $</span><br><span class="line"></span><br><span class="line">CALL test_while1(100)$</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">int i=0;</span><br><span class="line">while(i&lt;=insertCount)&#123;</span><br><span class="line">	i++;</span><br><span class="line">	if(i%2==0)&#123;</span><br><span class="line">		continue;</span><br><span class="line">	&#125;</span><br><span class="line">	插入</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">select * from admin $</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong><em>二、循环控制语句</em></strong> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">leave：类似于break，用于跳出所在的循环</span><br><span class="line">iterate：类似于continue，用于结束本次循环，继续下一次</span><br></pre></td></tr></table></figure></p>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> 学习</a>
              <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"><i class="fa fa-tag"></i> 数据库</a>
              <a href="/tags/MySQL/" rel="tag"><i class="fa fa-tag"></i> MySQL</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/03/04/MyBatis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="prev" title="MyBatis学习笔记">
      <i class="fa fa-chevron-left"></i> MyBatis学习笔记
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/03/04/nexT7.8%E7%BE%8E%E5%8C%96/" rel="next" title="nexT7.8美化">
      nexT7.8美化 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#mysql%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.</span> <span class="nav-text">MySQL数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#dml%E8%AF%AD%E8%A8%80"><span class="nav-number">1.1.</span> <span class="nav-text">DML语言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.1.1.</span> <span class="nav-text">插入语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.1.2.</span> <span class="nav-text">修改语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%8D%95%E8%A1%A8%E7%9A%84%E8%AE%B0%E5%BD%95"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">修改单表的记录★</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.1.3.</span> <span class="nav-text">删除语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E5%BC%8F%E4%B8%80delete"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">方式一：delete</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">两种方式的区别【面试题】★</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ddl%E8%AF%AD%E8%A8%80"><span class="nav-number">1.2.</span> <span class="nav-text">DDL语言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%93%E7%9A%84%E7%AE%A1%E7%90%86"><span class="nav-number">1.2.1.</span> <span class="nav-text">库的管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%BA%93"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">创建库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%BA%93"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">修改库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%BA%93"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">删除库</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E7%9A%84%E7%AE%A1%E7%90%86"><span class="nav-number">1.2.2.</span> <span class="nav-text">表的管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">表的创建 ★</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E5%9E%8B"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">日期型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E4%BF%AE%E6%94%B9%E8%A1%A8%E6%97%B6%E5%88%A0%E9%99%A4%E7%BA%A6%E6%9D%9F"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">三、修改表时删除约束</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.2.3.</span> <span class="nav-text">事务的使用步骤 ★</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">视图的修改</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.4.</span> <span class="nav-text">变量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">变量的介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%92%8C%E8%AF%AD%E6%B3%95"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">系统变量的介绍和语法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84"><span class="nav-number">1.2.4.3.</span> <span class="nav-text">二、循环结构</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="aeowind"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">aeowind</p>
  <div class="site-description" itemprop="description">爱上一场认真的消遣</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">55</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/aeowind" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;aeowind" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.douban.com/people/129971630/" title="douban → https:&#x2F;&#x2F;www.douban.com&#x2F;people&#x2F;129971630&#x2F;" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>douban</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">aeowind</span>
</div>



  <script>
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        document.title = '(*^▽^*)我藏好了哦~' + OriginTitle;
        clearTimeout(titleTime);
      } else {
        document.title = 'q(≧▽≦q)被你发现啦~' + OriginTitle;
        titleTime = setTimeout(function() {
          document.title = OriginTitle;
        }, 2000);
      }
    });
  </script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":1},"log":false});</script></body>
</html>

<!-- 页面点击小红心 -->

      <script type="text/javascript" src="/js/clicklove.js"></script>

